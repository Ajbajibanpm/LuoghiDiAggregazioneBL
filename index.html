<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mappatura Giovani Belluno</title>
    <style>
        :root {
            --bg: #0f172a;
            --card: #1e293b;
            --accent: #38bdf8;
            --text: #f1f5f9;
            --muted: #94a3b8;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        .container { max-width: 500px; width: 100%; }
        .card { background: var(--card); padding: 2rem; border-radius: 12px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .section-title { color: var(--accent); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 0.05em; margin: 1.5rem 0 1rem; border-bottom: 1px solid #334155; padding-bottom: 0.5rem; }
        .form-group { margin-bottom: 1.5rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        input, select { width: 100%; padding: 0.75rem; border-radius: 6px; border: 1px solid #334155; background: var(--bg); color: white; box-sizing: border-box; }
        .radio-group { display: grid; gap: 0.5rem; }
        .radio-option { background: #334155; padding: 0.75rem; border-radius: 6px; cursor: pointer; display: flex; align-items: center; }
        .radio-option input { margin-right: 10px; width: auto; }
        .other-input { margin-top: 0.5rem; display: none; }
        button { width: 100%; padding: 1rem; border-radius: 6px; border: none; font-weight: bold; cursor: pointer; }
        .btn-primary { background: var(--accent); color: var(--bg); margin-top: 1rem; }
        .btn-secondary { background: transparent; color: var(--muted); border: 1px solid var(--muted); margin-top: 0.5rem; font-size: 0.8rem; }
        .hidden { display: none; }
        .context-info { font-size: 0.85rem; color: var(--muted); margin-bottom: 1.5rem; line-height: 1.4; }
    </style>
</head>
<body>

<div class="container">
    <div id="personal-section" class="card">
        <div class="section-title">Profilo Utente</div>
        <p class="context-info">Il tuo contributo è essenziale per mappare gli spazi di aggregazione nella provincia di Belluno. Aiutaci a costruire un database per le politiche giovanili del territorio.</p>
        <div class="form-group"><label>Nome e Cognome</label><input type="text" id="user-name"></div>
        <div class="form-group"><label>Email</label><input type="email" id="user-email"></div>
        <div class="form-group"><label>Data di Nascita</label><input type="date" id="user-dob"></div>
        <button class="btn-primary" onclick="savePersonalData()">Inizia Mappatura</button>
    </div>

    <form id="place-form" class="card hidden">
        <div id="user-greeting" style="font-size: 0.8rem; color: var(--accent); margin-bottom: 1rem;"></div>
        
        <div class="section-title">Localizzazione</div>
        <div class="form-group">
            <label>Frazione Principale (Comune)</label>
            <select id="main-loc" onchange="populateSubLocs()" required></select>
        </div>
        <div class="form-group">
            <label>Località Minore</label>
            <select id="sub-loc" onchange="toggleOther(this, 'other-loc')" required disabled></select>
            <input type="text" id="other-loc" class="other-input" placeholder="Specifica località...">
        </div>
        <div class="form-group"><label>Nome del luogo</label><input type="text" id="place-name" required></div>

        <div class="section-title">Dettagli del Posto</div>
        <div class="form-group">
            <label>Tipologia</label>
            <select id="place-type" onchange="toggleOther(this, 'other-type')">
                <option value="civico">Centro Civico / Sociale</option>
                <option value="sport">Sport / Skatepark</option>
                <option value="cultura">Cultura / Studio</option>
                <option value="ritrovo">Bar / Ritrovo Informale</option>
                <option value="aperto">Parco / Piazza</option>
                <option value="altro">Altro...</option>
            </select>
            <input type="text" id="other-type" class="other-input" placeholder="Specifica tipologia...">
        </div>

        <div class="form-group">
            <label>Gestione</label>
            <select id="mgmt" onchange="toggleOther(this, 'other-mgmt')">
                <option value="comune">Comune / Ente Pubblico</option>
                <option value="associazione">Associazione / Parrocchia</option>
                <option value="privato">Privato</option>
                <option value="autorganizzato">Gruppo autorganizzato</option>
                <option value="altro">Altro...</option>
            </select>
            <input type="text" id="other-mgmt" class="other-input" placeholder="Specifica gestione...">
        </div>

        <div class="form-group">
            <label>Accesso</label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="access" value="libero" checked onclick="hideOther('other-access')"> Libero/Gratuito</label>
                <label class="radio-option"><input type="radio" name="access" value="tessera" onclick="hideOther('other-access')"> Tessera/Iscrizione</label>
                <label class="radio-option"><input type="radio" name="access" value="consumazione" onclick="hideOther('other-access')"> Solo consumazione</label>
                <label class="radio-option"><input type="radio" name="access" value="altro" onclick="showOther('other-access')"> Altro...</label>
            </div>
            <input type="text" id="other-access" class="other-input" placeholder="Specifica modalità accesso...">
        </div>

        <div class="section-title">La tua esperienza</div>
        <div class="form-group">
            <label>Tuo ruolo nel territorio</label>
            <select id="user-role" onchange="toggleOther(this, 'other-role')">
                <option value="studente">Studente</option>
                <option value="lavoratore">Lavoratore</option>
                <option value="volontario">Attivista / Volontario</option>
                <option value="residente">Residente</option>
                <option value="altro">Altro...</option>
            </select>
            <input type="text" id="other-role" class="other-input" placeholder="Specifica ruolo...">
        </div>

        <button type="button" class="btn-primary" onclick="submitForm()">Invia Risposta</button>
        <button type="button" class="btn-secondary" onclick="resetUser()">Cambia Utente (Reset)</button>
    </form>

    <div id="success-screen" class="card hidden" style="text-align:center;">
        <h2 style="color: var(--accent)">La tua risposta è stata registrata</h2>
        <p>Grazie per il tuo contributo alla causa sociale di Belluno.</p>
        <button class="btn-primary" onclick="newEntry()">Inserisci un altro luogo</button>
        <button class="btn-secondary" onclick="window.close()">Esci</button>
    </div>
</div>

<script>
    const locationData = {
        "Belluno (Capoluogo)": ["Antole", "Bolzano Bellunese", "Caviola", "Castion", "Cavessago", "Cet", "Chiesurazza", "Faverga", "Fiammoi", "Giamosa", "Giazzoi", "Levego", "Madeago", "Miér", "Nevegal", "Orzes", "Pedeserva", "Pra de Lante", "Rivamaor", "Sagrogna", "Sala", "Salce", "San Pietro in Campo", "Sopracroda", "Sois", "Sossai", "Tisoi", "Vezzano", "Vignole", "Visome"],
        "Feltre": ["Anzù", "Arson", "Canal di Limana", "Cart", "Fastro", "Foen", "Lasen", "Mugnai", "Nemeggio", "Pont", "Pren", "Tomo", "Umin", "Vellai", "Vignui", "Villabruna", "Villapaiera", "Zermen"],
        "Borgo Valbelluna": ["Mel", "Trichiana", "Lentiai", "Carve", "Cesana", "Col di Mel", "Confos", "Farra", "Marcador", "Morgan", "Nave", "Pellegai", "Ronchena", "Sant'Antonio Tortal", "Stabie", "Villa di Villa"],
        "Sedico": ["Bribano", "Libano", "Roe Alte", "Roe Basse", "Mas", "Peron", "Seghe di Villa", "Gresane"],
        "Santa Giustina": ["Cergnai", "Formegan", "Meano", "Ignan", "Sartena"],
        "Limana": ["Canè", "Cesa", "Coi di Navasa", "Dussoi", "Polentes", "Valmorel", "Triches"],
        "Cortina d'Ampezzo": ["Acquabona", "Alverà", "Campo di Sopra", "Chiave", "Col", "Cortina", "Grava", "Mortisa", "Pecol", "Socol", "Verocai", "Zuel"],
        "Pieve di Cadore": ["Nebbiù", "Pozzale", "Sottocastello", "Tai di Cadore"],
        "Auronzo di Cadore": ["Misurina", "Reane", "San Marco", "Villapiccola", "Villagrande"],
        "Santo Stefano di Cadore": ["Campolongo", "Casada", "Costalissoio"],
        "San Pietro di Cadore": ["Costalta", "Presenaio", "Valle"],
        "Calalzo di Cadore": ["Rizzios"],
        "Vigo di Cadore": ["Laggio", "Pelos", "Pinié"],
        "Agordo": ["Bries", "Brugnach", "Parech", "Prompicai", "Rif", "Toccol", "Valcozzena"],
        "Alleghe": ["Caprile", "Santa Maria delle Grazie", "Sala", "Tos"],
        "Falcade": ["Caviola", "Molino", "Sappade", "Somor"],
        "Rocca Pietore": ["Digonera", "Laste", "Malga Ciapela", "Sottoguda"],
        "Canale d'Agordo": ["Carfon", "Feder", "Garés"],
        "Val di Zoldo": ["Forno", "Dont", "Fusine", "Mareson", "Pecol", "Pieve", "Coi"],
        "Longarone": ["Castellavazzo", "Codissago", "Fortogna", "Igne", "Pirago", "Rivalta", "Roggia"],
        "Ponte nelle Alpi": ["Cadola", "Canevoi", "Casan", "Col di Cugnan", "Cornolade", "Cugnan", "Lastreghe", "Paiane", "Polpet", "Quantin", "Revelin", "Roncan", "Soccher"],
        "Alpago": ["Farra", "Pieve", "Puos", "Bastia", "Cornei", "Garna", "Sitran", "Tignes", "Torres", "Villa"],
        "Chies d'Alpago": ["Lamosano", "San Martino", "Funes"],
        "Tambre": ["All’Alpago", "Broz", "Sant'Anna"]
    };

    const mainSel = document.getElementById('main-loc');
    const subSel = document.getElementById('sub-loc');

    mainSel.innerHTML = '<option value="">Seleziona Comune...</option>';
    Object.keys(locationData).forEach(loc => {
        let opt = document.createElement('option');
        opt.value = loc;
        opt.textContent = loc;
        mainSel.appendChild(opt);
    });

    function populateSubLocs() {
        const selected = mainSel.value;
        subSel.innerHTML = '<option value="">Seleziona Località...</option>';
        if (selected && locationData[selected]) {
            locationData[selected].forEach(s => {
                let opt = document.createElement('option');
                opt.value = s;
                opt.textContent = s;
                subSel.appendChild(opt);
            });
            let otherOpt = document.createElement('option');
            otherOpt.value = "altro";
            otherOpt.textContent = "Altro...";
            subSel.appendChild(otherOpt);
            subSel.disabled = false;
        } else {
            subSel.disabled = true;
        }
    }

    function toggleOther(select, inputId) {
        const input = document.getElementById(inputId);
        input.style.display = (select.value === "altro") ? "block" : "none";
    }

    function showOther(id) { document.getElementById(id).style.display = 'block'; }
    function hideOther(id) { document.getElementById(id).style.display = 'none'; }

    function savePersonalData() {
        const nome = document.getElementById('user-name').value;
        const email = document.getElementById('user-email').value;
        const dob = document.getElementById('user-dob').value;
        if (!nome || !email || !dob) return alert("Compila i dati personali");
        localStorage.setItem('user_data', JSON.stringify({nome}));
        showForm(nome);
    }

    function showForm(name) {
        document.getElementById('personal-section').classList.add('hidden');
        document.getElementById('success-screen').classList.add('hidden');
        document.getElementById('place-form').classList.remove('hidden');
        document.getElementById('user-greeting').innerText = "Benvenuto, " + name;
    }

    function submitForm() {
        document.getElementById('place-form').classList.add('hidden');
        document.getElementById('success-screen').classList.remove('hidden');
    }

    function newEntry() {
        document.getElementById('place-form').reset();
        document.querySelectorAll('.other-input').forEach(i => i.style.display = 'none');
        subSel.disabled = true;
        showForm(JSON.parse(localStorage.getItem('user_data')).nome);
    }

    function resetUser() {
        localStorage.removeItem('user_data');
        location.reload();
    }

    window.onload = () => {
        const saved = localStorage.getItem('user_data');
        if (saved) showForm(JSON.parse(saved).nome);
    };
</script>
</body>
</html>
