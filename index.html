<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mappatura Giovani Belluno</title>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --accent: #38bdf8; --text: #f1f5f9; --muted: #94a3b8; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; display: flex; justify-content: center; }
        .container { max-width: 500px; width: 100%; }
        .card { background: var(--card); padding: 2rem; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .section-title { color: var(--accent); font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.1em; margin: 1.5rem 0 1rem; border-bottom: 1px solid #334155; padding-bottom: 0.3rem; }
        .form-group { margin-bottom: 1.2rem; }
        label { display: block; margin-bottom: 0.4rem; font-size: 0.9rem; }
        input, select { width: 100%; padding: 0.7rem; border-radius: 6px; border: 1px solid #334155; background: var(--bg); color: white; }
        .radio-group { display: grid; gap: 0.5rem; }
        .radio-option { background: #334155; padding: 0.7rem; border-radius: 6px; cursor: pointer; display: flex; align-items: center; font-size: 0.9rem; }
        .radio-option input { margin-right: 10px; width: auto; }
        button { width: 100%; padding: 1rem; border-radius: 6px; border: none; font-weight: bold; cursor: pointer; margin-top: 1rem; }
        .btn-primary { background: var(--accent); color: var(--bg); }
        .btn-secondary { background: transparent; color: var(--muted); border: 1px solid var(--muted); font-size: 0.8rem; }
        .hidden { display: none; }
        .context-box { font-size: 0.85rem; color: var(--muted); margin-bottom: 1.5rem; line-height: 1.4; }
    </style>
</head>
<body>

<div class="container">
    <div id="personal-section" class="card">
        <h2>Unisciti alla Mappa</h2>
        <div class="context-box">Il tuo contributo è fondamentale per mappare gli spazi di aggregazione giovanile nella Provincia di Belluno. Aiutaci a rendere il territorio più vivo e connesso.</div>
        <div class="section-title">I tuoi dati</div>
        <div class="form-group"><label>Nome e Cognome</label><input type="text" id="user-name"></div>
        <div class="form-group"><label>Email</label><input type="email" id="user-email"></div>
        <div class="form-group"><label>Data di Nascita</label><input type="date" id="user-dob"></div>
        <button class="btn-primary" onclick="savePersonalData()">Configura Profilo</button>
    </div>

    <form id="place-form" class="card hidden">
        <div id="user-greeting" style="font-size: 0.8rem; color: var(--accent); margin-bottom: 1rem;"></div>
        
        <div class="section-title">Dove si trova?</div>
        <div class="form-group">
            <label>Comune / Frazione Principale</label>
            <select id="main-loc" onchange="updateSubLocs()" required>
                <option value="">Seleziona Comune...</option>
            </select>
        </div>
        <div class="form-group">
            <label>Località / Frazione Minore</label>
            <select id="sub-loc" required disabled>
                <option value="">Seleziona prima il comune...</option>
            </select>
        </div>
        <div class="form-group"><label>Nome del Luogo (es. "Bar Centrale", "Skatepark")</label><input type="text" id="place-name" required></div>

        <div class="section-title">Caratteristiche</div>
        <div class="form-group">
            <label>Chi lo gestisce?</label>
            <select id="mgmt">
                <option value="pubblico">Pubblico (Comune)</option>
                <option value="privato">Privato (Esercente)</option>
                <option value="associazione">Associazione/Parrocchia</option>
                <option value="spontaneo">Nessuno (Spontaneo)</option>
            </select>
        </div>

        <div class="form-group">
            <label>Accessibilità</label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="access" value="libero" checked> Libero/Gratuito</label>
                <label class="radio-option"><input type="radio" name="access" value="consumazione"> Solo con consumazione</label>
                <label class="radio-option"><input type="radio" name="access" value="tessera"> Solo soci/tessera</label>
            </div>
        </div>

        <div class="form-group">
            <label>Quanto spesso ci vai?</label>
            <select id="freq">
                <option value="giornaliero">Ogni giorno</option>
                <option value="settimanale">Settimanalmente</option>
                <option value="occasionale">Raramente</option>
            </select>
        </div>

        <button type="button" class="btn-primary" onclick="submitForm()">Conferma e Invia</button>
        <button type="button" class="btn-secondary" onclick="resetUser()">Reset Profilo</button>
    </form>

    <div id="success-screen" class="card hidden" style="text-align:center;">
        <h2 style="color: var(--accent)">La tua risposta è stata registrata</h2>
        <p style="font-size: 0.9rem;">Grazie per aver contribuito alla causa sociale di Belluno.</p>
        <button class="btn-primary" onclick="newEntry()">Inserisci un altro luogo</button>
        <button class="btn-secondary" onclick="location.reload()">Chiudi</button>
    </div>
</div>

<script>
    const data = {
        "Belluno": ["Antole", "Bolzano Bellunese", "Caviola", "Castion", "Cavessago", "Cet", "Chiesurazza", "Faverga", "Fiammoi", "Giamosa", "Giazzoi", "Levego", "Madeago", "Miér", "Nevegal", "Orzes", "Pedeserva", "Pra de Lante", "Rivamaor", "Sagrogna", "Sala", "Salce", "San Pietro in Campo", "Sopracroda", "Sois", "Sossai", "Tisoi", "Vezzano", "Vignole", "Visome"],
        "Feltre": ["Anzù", "Arson", "Canal di Limana", "Cart", "Fastro", "Foen", "Lasen", "Mugnai", "Nemeggio", "Pont", "Pren", "Tomo", "Umin", "Vellai", "Vignui", "Villabruna", "Villapaiera", "Zermen"],
        "Borgo Valbelluna": ["Mel", "Trichiana", "Lentiai", "Carve", "Cesana", "Col di Mel", "Confos", "Farra", "Marcador", "Morgan", "Nave", "Pellegai", "Ronchena", "Sant'Antonio Tortal", "Stabie", "Villa di Villa"],
        "Sedico": ["Bribano", "Libano", "Roe Alte", "Roe Basse", "Mas", "Peron", "Seghe di Villa", "Gresane"],
        "Santa Giustina": ["Cergnai", "Formegan", "Meano", "Ignan", "Sartena"],
        "Limana": ["Canè", "Cesa", "Coi di Navasa", "Dussoi", "Polentes", "Valmorel", "Triches"],
        "Cortina d'Ampezzo": ["Acquabona", "Alverà", "Campo di Sopra", "Chiave", "Col", "Cortina", "Grava", "Mortisa", "Pecol", "Socol", "Verocai", "Zuel"],
        "Pieve di Cadore": ["Nebbiù", "Pozzale", "Sottocastello", "Tai di Cadore"],
        "Auronzo di Cadore": ["Misurina", "Reane", "San Marco", "Villapiccola", "Villagrande"],
        "Santo Stefano di Cadore": ["Campolongo", "Casada", "Costalissoio"],
        "San Pietro di Cadore": ["Costalta", "Presenaio", "Valle"],
        "Calalzo di Cadore": ["Rizzios"],
        "Vigo di Cadore": ["Laggio", "Pelos", "Pinié"],
        "Agordo": ["Bries", "Brugnach", "Parech", "Prompicai", "Rif", "Toccol", "Valcozzena"],
        "Alleghe": ["Caprile", "Santa Maria delle Grazie", "Sala", "Tos"],
        "Falcade": ["Caviola", "Molino", "Sappade", "Somor"],
        "Rocca Pietore": ["Digonera", "Laste", "Malga Ciapela", "Sottoguda"],
        "Canale d'Agordo": ["Carfon", "Feder", "Garés"],
        "Val di Zoldo": ["Forno", "Dont", "Fusine", "Mareson", "Pecol", "Pieve", "Coi"],
        "Longarone": ["Castellavazzo", "Codissago", "Fortogna", "Igne", "Pirago", "Rivalta", "Roggia"],
        "Ponte nelle Alpi": ["Cadola", "Canevoi", "Casan", "Col di Cugnan", "Cornolade", "Cugnan", "Lastreghe", "Paiane", "Polpet", "Quantin", "Revelin", "Roncan", "Soccher"],
        "Alpago": ["Farra", "Pieve", "Puos", "Bastia", "Cornei", "Garna", "Sitran", "Tignes", "Torres", "Villa"],
        "Chies d'Alpago": ["Lamosano", "San Martino", "Funes"],
        "Tambre": ["All’Alpago", "Broz", "Sant'Anna"]
    };

    const mainSelect = document.getElementById('main-loc');
    const subSelect = document.getElementById('sub-loc');

    Object.keys(data).forEach(comune => {
        let opt = document.createElement('option');
        opt.value = comune;
        opt.innerHTML = comune;
        mainSelect.appendChild(opt);
    });

    function updateSubLocs() {
        const selected = mainSelect.value;
        subSelect.innerHTML = '<option value="">Seleziona Località...</option>';
        if (selected) {
            data[selected].forEach(loc => {
                let opt = document.createElement('option');
                opt.value = loc;
                opt.innerHTML = loc;
                subSelect.appendChild(opt);
            });
            subSelect.disabled = false;
        } else {
            subSelect.disabled = true;
        }
    }

    function savePersonalData() {
        const n = document.getElementById('user-name').value;
        const e = document.getElementById('user-email').value;
        const d = document.getElementById('user-dob').value;
        if(!n || !e || !d) return alert("Compila i dati personali.");
        localStorage.setItem('user_data', JSON.stringify({n}));
        showForm(n);
    }

    function showForm(name) {
        document.getElementById('personal-section').classList.add('hidden');
        document.getElementById('success-screen').classList.add('hidden');
        document.getElementById('place-form').classList.remove('hidden');
        document.getElementById('user-greeting').innerText = "Inviando come: " + name;
    }

    function submitForm() {
        document.getElementById('place-form').classList.add('hidden');
        document.getElementById('success-screen').classList.remove('hidden');
    }

    function newEntry() {
        document.getElementById('place-form').reset();
        subSelect.disabled = true;
        showForm(JSON.parse(localStorage.getItem('user_data')).n);
    }

    function resetUser() {
        localStorage.clear();
        location.reload();
    }

    window.onload = () => {
        const saved = localStorage.getItem('user_data');
        if(saved) showForm(JSON.parse(saved).n);
    };
</script>
</body>
</html>
